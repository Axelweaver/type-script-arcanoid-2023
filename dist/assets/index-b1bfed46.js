var B=Object.defineProperty;var I=(s,t,i)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var c=(s,t,i)=>(I(s,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();class x{constructor(t,i,o,e,n){c(this,"moveLeft");c(this,"moveRight");c(this,"_color");c(this,"handleKeyUp",t=>{(t.code==="ArrowLeft"||t.key==="ArrowLeft"||t.code==="KeyA"||t.key.toUpperCase()==="A")&&(this.moveLeft=!1),(t.code==="ArrowRight"||t.key==="ArrowRight"||t.code==="KeyD"||t.key.toUpperCase()==="D")&&(this.moveRight=!1)});c(this,"handleKeyDown",t=>{(t.code==="ArrowLeft"||t.key==="ArrowLeft"||t.code==="KeyA"||t.key.toUpperCase()==="A")&&(this.moveLeft=!0),(t.code==="ArrowRight"||t.key==="ArrowRight"||t.code==="KeyD"||t.key.toUpperCase()==="D")&&(this.moveRight=!0)});this.speed=t,this.platformWidth=i,this.platformHeight=o,this._position=e,this.speed=t,this.platformWidth=i,this.platformHeight=o,this._position=e,this.moveLeft=!1,this.moveRight=!1,this._color=n,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}get width(){return this.platformWidth}get height(){return this.platformHeight}get position(){return this._position}get isMovingLeft(){return this.moveLeft}get isMovingRight(){return this.moveRight}get color(){return this._color}move(){this.moveLeft&&(this.position.x-=this.speed),this.moveRight&&(this.position.x+=this.speed)}}class M{constructor(t,i,o,e){c(this,"speed");c(this,"_color");c(this,"_radius");c(this,"_radiusSquare");this._ballSize=i,this._position=o,this._ballSize=i,this._position=o,this.speed={x:t,y:-t},this._color=e,this._radius=Math.round(this._ballSize/2),this._radiusSquare=this._radius*this._radius}get width(){return this._ballSize}get height(){return this._ballSize}get radius(){return this._radius}get radiusSquare(){return this._radiusSquare}get position(){return this._position}get color(){return this._color}changeYDirection(){this.speed.y=-this.speed.y}changeXDirection(){this.speed.x=-this.speed.x}moveBall(){this.position.x+=this.speed.x,this.position.y+=this.speed.y}}const P="/type-script-arcanoid-2023/assets/emptyheart-cdbc192a.png",T="/type-script-arcanoid-2023/assets/filledheart-7a401f85.png",d=document.querySelector("#gameCanvas"),R=3,u=10,D=20,y=10,f=5,S=d!=null?Math.floor((d.width-u*2)/y)-f:100,C=d!=null?Math.floor((d.height-u*2)/D)-f:30,w={0:P,1:T},p=20,k=150,E=25,F=450,K=10,G="#FFF8DC",H=3,W=14,Y=500,q=400,z="#F0F8FF",N="#00FFFF",X="#7FFFD4",U="#DC143C",V="#008000",L="#FFFFF0",$="#A52A2A",Z="#228B22",j="#EEE8AA",J="#4169E1",Q="#663399",b={1:$,2:Z,3:j,4:J,5:Q},tt={1:1,2:1,3:2,4:2,5:3},it=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,2,2,2,2,2,2,2,2,0,0,3,3,3,3,3,3,3,3,0,0,0,4,4,4,4,4,4,0,0,0,0,5,5,0,0,5,5,0,0];class st{constructor(t,i,o,e,n){c(this,"brickColor");this._brickWidth=t,this._brickHeight=i,this._position=o,this._brickEnergy=e,this._brickWidth=t,this._brickHeight=i,this._position=o,this._brickEnergy=e,this.brickColor=n}blink(){if(this._brickEnergy<=0)return;const t=this.brickColor;this.brickColor=N,setTimeout(()=>{this.brickColor=t},70)}get width(){return this._brickWidth}get height(){return this._brickHeight}get position(){return this._position}get color(){return this.brickColor}get energy(){return this._brickEnergy}set energy(t){this._brickEnergy=t,this.blink()}}function A(){return new M(H,W,{x:Y,y:q},z)}function ot(){return it.reduce((s,t,i)=>{const o=Math.floor((i+1)/y),e=i%y,n=u+e*(S+f),r=u+o*(C+f);return t===0?s:[...s,new st(S,C,{x:n,y:r},tt[t],b[t])]},[])}function O(s){return new x(K,k,E,{x:F,y:s-E-5},G)}function et(s,t,i,o,e){s!=null&&(s.fillStyle=t,s.beginPath(),s.arc(i,o,e*2,0,2*Math.PI,!1),s.fill())}function nt(s,t,i,o,e,n){if(s==null)return;const r=new Image;r.src=t,s.drawImage(r,i,o,e,n)}function rt(s,t,i,o){if(s==null)return;const e=Math.round(s.canvas.width/100);for(let n=0;n<R;n++){const r=t>n?w[1]:w[0];nt(s,r,i,o,p,p),i+=p+e}}function m(s,t,i,o,e,n){s!=null&&(s.fillStyle=t,s.beginPath(),s.rect(i,o,e,n),s.fill(),s.stroke())}function _(s,t,i,o,e,n,r="left"){s!=null&&(s.fillStyle=t,s.font=i,s.textAlign=r,s.textBaseline="middle",s.fillText(n,o,e))}class ct{constructor(t){c(this,"canvas");c(this,"context");this.canvas=document.querySelector(t),this.context=this.canvas.getContext("2d")}clear(){var t;(t=this.context)==null||t.clearRect(0,0,this.canvas.width,this.canvas.height)}initStartButton(t){const i=o=>{(o.code==="Space"||o.key==="Space")&&t(this)};document.addEventListener("keypress",i),this.drawInfo("GET READY",L),this.waitPressToStart()}waitPressToStart(){this.drawSecondaryInfo("press space",L)}drawScore(t){const i=Math.round(this.canvas.height/24),o=this.canvas.width-Math.round(this.canvas.width/8),e=`score: ${t}`,r=`bold ${Math.round(this.canvas.height/33)}px Verdana`;_(this.context,X,r,o,i,e,"left")}showLives(t){const i=Math.round(this.canvas.height/36),o=Math.round(this.canvas.width*.025);rt(this.context,t,o,i)}drawInfo(t,i){const o=Math.round(this.canvas.height/2),e=Math.round(this.canvas.width/2),r=`bold ${Math.round(this.canvas.width/18)}px Verdana`;_(this.context,i,r,e,o,t,"center")}drawSecondaryInfo(t,i){const o=Math.round(this.canvas.height/2)+Math.round(this.canvas.height/5),e=Math.round(this.canvas.width/2),r=`bold ${Math.round(this.canvas.width/22)}px Verdana`;_(this.context,i,r,e,o,t,"center")}drawPlatform(t){m(this.context,t.color,t.position.x,t.position.y,t.width,t.height)}drawBall(t){et(this.context,t.color,t.position.x,t.position.y,t.radius)}drawBrick(t){m(this.context,t.color,t.position.x,t.position.y,t.width,t.height)}drawBricks(t){t.forEach(i=>{this.drawBrick(i)})}}class ht{checkCollisionCircleWithRect(t,i){const o=Math.max(i.position.x,Math.min(t.position.x,i.position.x+i.width)),e=Math.max(i.position.y,Math.min(t.position.y,i.position.y+i.height));return(o-t.position.x)**2+(e-t.position.y)**2<t.radiusSquare}isSideColliding(t,i){return t.position.y>i.position.y&&t.position.y<i.position.y+i.height&&(t.position.x<i.position.x||t.position.x>i.position.x+i.width)}isCollidingBricks(t,i){let o=!1;return i.forEach((e,n)=>{this.checkCollisionCircleWithRect(t,e)&&(t.changeYDirection(),this.isSideColliding(t,e)&&t.changeXDirection(),e.energy===1?i.splice(n,1):e.energy-=1,o=!0)}),o}checkBallCollision(t,i,o){this.checkCollisionCircleWithRect(t,i)&&(t.changeYDirection(),this.isSideColliding(t,i)&&t.changeXDirection()),(t.position.x>o.canvas.width-t.radius||t.position.x-t.radius<=0)&&t.changeXDirection(),t.position.y-t.radius<=0&&t.changeYDirection()}}let l=!1,g=!0,a=0,h=R;function at(s){s.drawInfo("Game Over!",U),l=!1,s.waitPressToStart()}function dt(s){s.drawInfo("Game Won!",V),l=!1,s.waitPressToStart()}function v(s,t,i,o,e){if(s.clear(),s.drawScore(a),s.showLives(h),s.drawBricks(t),s.drawPlatform(i),g){if(o.moveBall(),s.drawBall(o),(i.isMovingLeft&&i.position.x>0||i.isMovingRight&&i.position.x<s.canvas.width-i.width)&&i.move(),e.checkBallCollision(o,i,s),e.isCollidingBricks(o,t)&&(a+=1,s.drawScore(a)),o.position.y-o.height>s.canvas.height&&(h=h-1,h<1?l=!0:g=!1),t.length===0){dt(s);return}if(l){at(s);return}}else s.drawInfo("GET READY!",L),s.waitPressToStart(),o.position.y-o.height>s.canvas.height&&(o=A(),i=O(s.canvas.height));requestAnimationFrame(()=>{v(s,t,i,o,e)})}function ut(s){if(g){ft(s);return}g=!0}function ft(s){a=0,h=R,s.drawScore(0);const t=new ht,i=ot(),o=A(),e=O(s.canvas.height);v(s,i,e,o,t)}const lt=new ct("#gameCanvas");lt.initStartButton(ut);
